/* --- RESET Y BASE --- */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none; /* Evita que seleccionen texto al jugar rápido */
}

:root {
    /* MODO CLARO (Default) */
    --bg-body: #f8fafc;
    --bg-panel: #ffffff;
    --border-color: #e2e8f0;
    --text-main: #1e293b;
    --text-muted: #64748b;
    --bg-input: #f1f5f9;
    --bg-cell: #ffffff;
}

body.dark-mode {
    /* MODO OSCURO */
    --bg-body: #0f172a;
    --bg-panel: #1e293b;
    --border-color: #334155;
    --text-main: #f1f5f9;
    --text-muted: #94a3b8;
    --bg-input: #334155;
    --bg-cell: #0f172a;
}

body {
    background-color: var(--bg-body);
    color: var(--text-main);
    transition: background-color 0.3s, color 0.3s;
    /*background-color: #0f172a;  Azul muy oscuro (Slate 900) 
    color: #f1f5f9;*/
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    overflow-x: hidden;
}

/* --- BARRA SUPERIOR DE CONTROL (Dashboard Style) --- */
/* Agrupamos visualmente el botón de ayuda, objetivo y settings */
.top-bar-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    padding: 10px 20px;
    /*background-color: #1e293b;*/
    border-bottom: 1px solid #334155;
    flex-wrap: wrap;
    background-color: var(--bg-panel);
    border-color: var(--border-color);
}

.help-btn {
    background: #3b82f6;
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    color: white;
    font-weight: bold;
    cursor: pointer;
    font-size: 1.2rem;
}

.tournament-goal, .settings-bar {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.9rem;
    color: #cbd5e1;
}

.settings-bar {
    gap: 15px;
}

.setting-item {
    display: flex;
    align-items: center;
    gap: 5px;
}

/* Inputs y Selects más estilizados */
input[type="number"], select {
    background-color: var(--bg-input);
    color: var(--text-main);
    border: 1px solid var(--border-color);
    /*background-color: #334155;
    border: 1px solid #475569;
    color: white;*/
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 0.9rem;
    text-align: center;
}


.tournament-goal input { width: 50px; }
#timeInput { width: 60px; }
select { cursor: pointer; }

/* Estados bloqueados */
.locked { opacity: 0.6; pointer-events: none; filter: grayscale(1); }

/* --- LAYOUT PRINCIPAL (GRID 3 COLUMNAS) --- */
.layout {
    display: grid;
    /* Columna Izq (250px) - Centro (Flexible) - Columna Der (250px) */
    grid-template-columns: 280px 1fr 280px; 
    gap: 20px;
    padding: 10px 20px;
    flex-grow: 1; /* Ocupa el espacio restante */
    max-width: 1400px;
    margin: 0 auto;
    width: 100%;
    align-items: start; /* Alineación superior */
}

/* --- PANELES LATERALES (EQUIPOS) --- */
.side {
    /*background-color: #1e293b;*/
    padding: 20px;
    border-radius: 12px;
    border: 1px solid #334155;
    height: fit-content;
    min-height: 400px; /* Altura mínima visual */
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    background-color: var(--bg-panel);
    border-color: var(--border-color);
}

.team-name {
    text-align: center;
    font-size: 1.3rem;
    margin-bottom: 10px;
    padding-bottom: 10px;
    border-bottom: 2px solid;
   /* color: #f8fafc;*/
}

#nameA { border-color: #3b82f6; } /* Azul */
#nameB { border-color: #f43f5e; } /* Rojo */

.turn-stat {
    text-align: center;
    font-size: 0.9rem;
    color: #94a3b8;
    margin-bottom: 15px;
}

/* --- ÁREA CENTRAL DE JUEGO --- */
.game {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
}

/* Banner de turno mejorado */
.turn-banner {
    width: 100%;
    max-width: 400px;
    margin: 0 auto 10px auto; /* Centrado */
    padding: 8px;
    border-radius: 8px;
    font-weight: 900;
    font-size: 1.1rem;
    text-align: center;
    transition: all 0.5s ease;
    border: 2px solid transparent;
}
.turn-team-A { background: rgba(59, 130, 246, 0.15); color: #3b82f6; border-color: #3b82f6; }
.turn-team-B { background: rgba(244, 63, 94, 0.15); color: #f43f5e; border-color: #f43f5e; }
.active-turn-pulse { animation: pulse-turn 2s infinite; }
@keyframes pulse-turn { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.02); } }

/* Timer y Marcador */
#timer {
    font-size: 2rem;
    font-weight: bold;
    color: #e2e8f0;
    margin-bottom: 5px;
}
#timer.active { color: #22c55e; text-shadow: 0 0 10px rgba(34, 197, 94, 0.4); }

/* GRID DEL JUEGO */
.grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 5px;
    margin-bottom: 15px;
}

.cell {
    width: 52px;  /* Tamaño fijo escritorio */
    height: 52px;
    border: 2px solid #334155;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    font-weight: bold;
    text-transform: uppercase;
   /* background-color: #0f172a;*/
    transition: all 0.2s;
      background-color: var(--bg-cell);
    border-color: var(--border-color);
    color: var(--text-main);
}

/* Colores de celdas */
.correct { background-color: #22c55e; border-color: #22c55e; }
.present { background-color: #eab308; border-color: #eab308; }
.absent { background-color: #475569; border-color: #475569; }
.cell-error { animation: shake 0.4s; border-color: #ef4444; }
.win-bounce { animation: bounce 0.6s; }

/* TECLADO */
#keyboard {
    display: flex;
    flex-direction: column;
    gap: 6px;
    width: 100%;
    max-width: 500px;
}
.keyboard-row { display: flex; justify-content: center; gap: 4px; }
.key {
    background-color: #64748b;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 12px 0;
    flex: 1;
    font-weight: bold;
    cursor: pointer;
    font-size: 0.9rem;
    transition: 0.2s;
    min-width: 30px;
}
.key:hover { background-color: #94a3b8; }
.key.correct { background-color: #22c55e; }
.key.present { background-color: #eab308; }
.key.absent { background-color: #1e293b; opacity: 0.5; }

/* Botón Siguiente */
.btn-next {
    margin-top: 15px;
    padding: 12px 30px;
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    border: none;
    color: white;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    box-shadow: 0 4px 10px rgba(99, 102, 241, 0.4);
    transition: transform 0.2s;
}
.btn-next:active { transform: scale(0.95); }
.btn-next:disabled { background: #475569; cursor: not-allowed; box-shadow: none; opacity: 0.6; }

/* Botón Reiniciar Torneo (Abajo a la derecha o centrado abajo) */
.btn-reset-all {
    margin: 20px auto;
    background: transparent;
    border: 1px solid #ef4444;
    color: #ef4444;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 0.8rem;
    cursor: pointer;
    opacity: 0.7;
    transition: 0.3s;
    display: block;
}
.btn-reset-all:hover { opacity: 1; background: rgba(239, 68, 68, 0.1); }

/* Footer */
.game-footer {
    margin-top: auto; /* Empuja el footer al final */
    padding: 15px 0;
    text-align: center;
    border-top: 1px solid rgba(255,255,255,0.05);
}
.game-footer p { color: #64748b; font-size: 0.85rem; }
.game-footer strong { color: #94a3b8; }
.game-footer strong:hover { color: #3b82f6; cursor: default; }


/* --- OVERLAYS Y ANIMACIONES (Sin cambios mayores) --- */
#winnerOverlay, .roulette-overlay, .tutorial-overlay, .modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; justify-content: center; align-items: center;
    z-index: 1000;
}
#winnerOverlay { background: rgba(15, 23, 42, 0.95); flex-direction: column; display: none; }
.roulette-overlay { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px); }
.roulette-box { font-size: 2rem; color: white; text-align: center; }
.roulette-anim { animation: spin-text 0.1s infinite; }

/* Animaciones */
@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
@keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-15px); } 60% { transform: translateY(-7px); } }
.confetti { position: fixed; width: 10px; height: 10px; animation: fall linear forwards; z-index: 999; }
@keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }

/* --- RESPONSIVE DESIGN --- */

/* Ajustes para Laptops pequeñas (altura < 700px) */
@media (max-height: 700px) {
    .grid { gap: 3px; margin-bottom: 5px; }
    .cell { width: 40px; height: 40px; font-size: 1.4rem; }
    .key { padding: 8px 0; font-size: 0.8rem; }
    .top-bar-container { padding: 5px; }
}

/* Tabletas y Móviles (Pantallas < 900px) */
@media (max-width: 900px) {
    .layout {
        display: flex;
        flex-direction: column; /* Apilar verticalmente */
        padding: 10px;
    }

    .side {
        width: 100%;
        min-height: auto;
        flex-direction: row; /* Poner nombre y stats en linea */
        justify-content: space-between;
        align-items: center;
        padding: 10px 15px;
        margin-bottom: 10px;
    }
    
    .team-name { margin: 0; border: none; font-size: 1.1rem; }
    .turn-stat { margin: 0; }
    
    /* Ocultar gráficos de historial en móvil para ahorrar espacio si se desea */
    #histA, #histB { display: none; } 

    .cell { width: 55px; height: 55px; } /* En móvil las celdas deben ser grandecitas para tocar */
    
    /* El orden visual: Juego primero, Equipos abajo */
    .game { order: 1; margin-bottom: 20px; }
    .side:nth-child(1) { order: 2; border-left: 5px solid #3b82f6; } /* Equipo A */
    .side:nth-child(3) { order: 3; border-left: 5px solid #f43f5e; } /* Equipo B */
}

/* Móviles pequeños */
@media (max-width: 480px) {
    .cell { width: 13vw; height: 13vw; max-width: 50px; max-height: 50px; }
    .top-bar-container { flex-direction: column; gap: 5px; }
}

.highlight-focus {
    position: relative;
    z-index: 1001 !important; /* Por encima del overlay oscuro */
    background-color: #1e293b !important;
    box-shadow: 0 0 20px 10px rgba(59, 130, 246, 0.5);
    border-radius: 8px;
    pointer-events: none; /* Evita que el usuario toque mientras está en tutorial */
}

.tutorial-overlay {
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 1000;
}

.tutorial-arrow {
    position: fixed;
    width: 0; height: 0;
    border-left: 12px solid transparent;
    border-right: 12px solid transparent;
    border-bottom: 20px solid #3b82f6;
    transform: rotate(var(--rot));
    z-index: 1002;
    transition: all 0.3s ease;
}

.step-card {
    position: fixed;
    background: white;
    color: #1e293b;
    padding: 20px;
    border-radius: 12px;
    width: 300px;
    z-index: 1002;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
}
/* Asegura que el modal no se estire y se vea centrado */
.modal-content {
    /*background: #f2f2f2;*/
    background-color: var(--bg-panel);
    color: var(--text-main);
    border: 1px solid var(--border-color);
    padding: 30px;
    border-radius: 20px;
    max-width: 400px; /* Ancho fijo para que no se estire */
    width: 90%;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column; /* Todo uno debajo de otro */
    align-items: center;
    text-align: center;
}


.modal-content h2, p{
    color: #475569;
}


/* Contenedor para las filas de ejemplo (GATOS, PERRO, etc) */
.example-row {
    display: flex;
    gap: 5px;
    margin: 10px 0;
    justify-content: center;
}

/* Celdas pequeñas para el tutorial (para que no ocupen toda la pantalla) */
.example-row .cell-mini {
    width: 35px;
    height: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 900;
    border-radius: 6px;
    color: white;
    font-size: 1rem;
}

.example-row p {
    color: var(--text-muted);
}

.fair-play {
  background: #f5f7fa;
  border-left: 4px solid #ff9800;
  padding: 12px 16px;
  border-radius: 6px;
  font-size: 13px;
  line-height: 1.5;
  color: #333;
}

.fair-play strong {
  display: block;
  font-size: 14px;
  margin-bottom: 6px;
  color: #222;
}

.fair-play span {
  display: block;
  margin-bottom: 4px;
}

.fair-play .warning {
  font-weight: 600;
  color: #d32f2f;
}

.fair-play .limit {
  font-weight: 500;
  color: #1565c0;
}
.dark-mode .fair-play {
    background: #2d3748; /* Un gris oscuro azulado */
    color: #e2e8f0;
    border-left-color: #f6ad55; /* Naranja más suave para modo oscuro */
}

.dark-mode .fair-play strong {
    color: #fff;
}

.dark-mode .fair-play .limit {
    color: #90cdf4; /* Azul claro para que se lea bien */
}